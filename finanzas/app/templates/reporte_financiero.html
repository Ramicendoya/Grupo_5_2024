{% extends 'base.html' %}
{% load static %}

{% block main %}
<div class="container mt-4">
    <div class="row">
        <!-- Título -->
        <div class="col-12 text-center">
            <p class="title" style="font-size: 24px; font-weight: bold;">Informe Financiero</p>
        </div>
        
        
        <!-- Selectores -->
        <div class="col-12 mt-2">
            <div class="d-flex justify-content-between align-items-center">          
                <!-- Selector de Gastos o Ingresos-->
                <div class="btn-group" role="group" aria-label="GastosIngresos">
                    <button type="button" class="btn btn-outline-secondary">Gastos</button>
                    <button type="button" class="btn btn-outline-secondary">Ingresos</button>
                </div>
                <!-- Selector de Mes o Año -->
                <div class="btn-group" role="group" aria-label="MesAño">
                    <button type="button" class="btn btn-outline-secondary">Mes</button>
                    <button type="button" class="btn btn-outline-secondary">Año</button>
                </div>
            </div>
        </div>

        <!-- Meses seleccionables -->
        <div class="col-12 mt-3">
            <div class="d-flex justify-content-between">
                <a href="#" class="text-dark">Enero</a>
                <a href="#" class="text-dark">Febrero</a>
                <a href="#" class="text-dark">Marzo</a>
                <a href="#" class="text-dark">Abril</a>
                <a href="#" class="text-dark">Mayo</a>
                <a href="#" class="text-dark">Junio</a>
                <a href="#" class="text-dark">Julio</a>
                <a href="#" class="text-dark">Agosto</a>
                <a href="#" class="text-dark">Septiembre</a>
                <a href="#" class="text-dark"><strong>Octubre</strong></a>
                <a href="#" class="text-dark">Noviembre</a>
                <a href="#" class="text-dark">Diciembre</a>
            </div>
        </div>

        <div class="col-12 d-flex mt-4">
            <!-- Gráfico de Google Charts -->
            <div id="google-chart-container" class="flex-fill" style="flex: 1;">
                <div id="google-piechart" style="width: 100%; height: 600px;"></div>
            </div>

            <!-- Detalle Categoria -->
            <div class="ml-4" id="detalle_categoria">
                <h5>Detalles de la Categoría</h5>
                <p>Aquí se mostrarán los detalles de la categoría seleccionada.</p>
            </div>
        </div>

        <!-- Leyenda personalizada -->
        <div class="ml-4 d-flex flex-column align-items-start" style="margin-left: 20px;">
            <span style="color: #FF6384;"><i class="bi bi-cart"></i> Compras</span>
            <span style="color: #36A2EB;"><i class="bi bi-cash-stack"></i> Deuda</span>
            <span style="color: #FFCE56;"><i class="bi bi-house"></i> Vivienda</span>
            <span style="color: #4BC0C0;"><i class="bi bi-scissors"></i> Belleza</span>
        </div>
    </div>
</div>


<style>
    #detalle_categoria{
        margin-top: 8%;
    }
</style>


<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<script>
    // Configuración del gráfico de Google Charts
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
        var data = google.visualization.arrayToDataTable([
            ['Categoría', 'Porcentaje'],
            ['Compras', 40.30],
            ['Deuda', 23.99],
            ['Vivienda', 20.31],
            ['Belleza', 15.40]
        ]);

        var options = {
            title: 'Distribución de Gastos',
            pieSliceText: 'percentage',
            slices: {
                0: { color: '#FF6384' },
                1: { color: '#36A2EB' },
                2: { color: '#FFCE56' },
                3: { color: '#4BC0C0' }
            },
            legend: { position: 'right', alignment: 'center' }
        };

        var chart = new google.visualization.PieChart(document.getElementById('google-piechart'));
        chart.draw(data, options);

        // Captura de clic en la leyenda
        google.visualization.events.addListener(chart, 'select', function() {
            var selectedItem = chart.getSelection()[0];
            if (selectedItem) {
                var category = data.getValue(selectedItem.row, 0); // Obtiene la categoría seleccionada
                var percentage = data.getValue(selectedItem.row, 1); // Obtiene el porcentaje

                // Actualiza la sección de detalles con información relevante
                document.getElementById('detalle_categoria').innerHTML = `
                    <h5>Detalles de la Categoría</h5>
                    <p>Categoría: ${category}</p>
                    <p>Porcentaje: ${percentage}%</p>
                    <p>Monto: $1000%</p>
                `;
            }
        });
    }
</script>
{% endblock %}
